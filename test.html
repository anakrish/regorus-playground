<!DOCTYPE html>
<html>
<head>
    <title>WASM Test</title>
</head>
<body>
    <h1>Regorus WASM Test</h1>
    <div id="output"></div>
    <button onclick="testRegorus()">Test WASM</button>

    <script type="module">
        import init, { Engine } from './pkg/regorusjs.js';
        
        window.testRegorus = async function() {
            const output = document.getElementById('output');
            try {
                output.innerHTML = '<p>Loading WASM...</p>';
                
                // Initialize WASM
                await init();
                output.innerHTML += '<p>✅ WASM initialized</p>';
                
                // Create engine
                const engine = new Engine();
                output.innerHTML += '<p>✅ Engine created</p>';
                
                // Add simple policy
                const pkg = engine.addPolicy('test.rego', `
                    package test
                    x = 42
                `);
                output.innerHTML += `<p>✅ Policy added: ${pkg}</p>`;
                
                // Evaluate
                const result = engine.evalRule('data.test.x');
                output.innerHTML += `<p>✅ Result: ${result}</p>`;
                
            } catch (error) {
                output.innerHTML += `<p>❌ Error: ${error.message}</p>`;
                console.error('Error:', error);
            }
        };
    </script>
</body>
</html>